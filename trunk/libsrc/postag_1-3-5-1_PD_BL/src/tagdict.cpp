/**
 * @file tagdict.cpp
 * @brief Implementation some operations relative with dictionary.
 * @author David Dai
 * @version 1.0
 * @date 2007/09/25 
 */

#include "tagdict.h"

/* 所有词性标记集合 */
const char* POS_TAG_SET[POS_TAG_COUNT] = 
{"Ag", "Dg", "Ng", "Tg", "Vg", "a", "ad", "an", "b", "c", "d", "e",  "f",  "g",  "h",  "i", "j",  "k",  "l", "m", "n", "nr", "ns", "nt", "nx", "nz", "o", "p",  "q", "r", "s",  "t",  "u",  "v",  "vd", "vn", "w", "y",  "z"};

/* 每个标记出现的总次数(取了log) */
const double POS_TAG_PROB[POS_TAG_COUNT] = {8.85623355614316,7.11720550316434,11.3085668664344,7.91388671485608,9.29219681844602,13.2804178560553,11.6164022074409,10.371207325767,11.8272835476319,12.991865094534,13.5972774307598,5.85220247977447,12.5594195577095,0,7.57814547241947,11.2943838086757,12.1640207282983,9.57394127598565,11.3563535229186,13.3746042652779,15.1730990704742,12.8162212959409,13.0305550589201,10.954396586135,7.96137020171951,10.9747971586762,6.69703424766648,13.4270412003803,12.8136020230796,13.1867887671428,10.9728426601371,12.6612893602357,14.0328943536869,14.9500885886228,9.0280988119824,13.5496291154713,14.8346960881121,10.207178299633,9.79901553093942};

/* 转移频率矩阵(取了log) */
const double TRANS_PROB_MATRIX[POS_TAG_COUNT][POS_TAG_COUNT] = {
  {4.98360662170834,1.09861228866811,6.40687998606931,1.09861228866811,3.52636052461616,5.73334127689775,1.94591014905531,0.693147180559945,2.94443897916644,4.89034912822175,4.77068462446567,0.693147180559945,3.71357206670431,0,0,1.09861228866811,2.56494935746154,2.89037175789616,1.79175946922805,4.18965474202643,7.36010397298915,1.6094379124341,2.07944154167984,0.693147180559945,0,0,0,4.40671924726425,2.30258509299405,3.73766961828337,1.38629436111989,3.17805383034795,6.03068526026126,7.10002716662926,0.693147180559945,3.73766961828337,7.58426481838906,4.20469261939097,1.79175946922805},
  {3.66356164612965,0,1.6094379124341,0,2.94443897916644,5.82008293035236,0,0,0,1.6094379124341,3.13549421592915,0,0.693147180559945,0,0,0.693147180559945,0,3.68887945411394,2.07944154167984,2.77258872223978,2.39789527279837,0,0.693147180559945,0,0,0,0,2.83321334405622,0,1.79175946922805,0,2.07944154167984,0.693147180559945,6.52795791762255,0,0,3.13549421592915,1.09861228866811,0},
  {5.63835466933375,2.83321334405622,6.99117688712121,1.94591014905531,5.18738580584075,7.2152399787301,5.57972982598622,2.30258509299405,5.28320372873799,6.93634273583405,8.14322675036744,1.38629436111989,7.61972421378267,0,1.09861228866811,5.28320372873799,5.41164605185504,4.62497281328427,5.36597601502185,7.34601020991329,9.22876950744455,5.64544689764324,7.63916117165917,6.5206211275587,0.693147180559945,5.12396397940326,1.6094379124341,7.81197342962202,3.29583686600433,6.1779441140506,4.66343909411207,7.20414929203594,8.44290058683438,9.58582725656466,3.2188758248682,6.75227037614174,10.3172184050613,5.10594547390058,4.60517018598809},
  {1.09861228866811,0.693147180559945,3.29583686600433,5.04985600724954,3.97029191355212,3.61091791264422,2.30258509299405,0.693147180559945,1.94591014905531,2.83321334405622,5.72031177660741,0,4.24849524204936,0,0,1.38629436111989,2.19722457733622,0,1.09861228866811,4.29045944114839,5.4249500174814,2.94443897916644,3.91202300542815,0.693147180559945,0,2.30258509299405,0,5.29330482472449,1.94591014905531,2.30258509299405,1.09861228866811,4.81218435537242,4.75359019110636,6.26339826259162,0,2.56494935746154,6.49072353450251,1.6094379124341,1.38629436111989},
  {3.78418963391826,1.38629436111989,5.89440283426485,3.63758615972639,3.71357206670431,5.73979291217923,2.56494935746154,3.55534806148941,3.91202300542815,4.31748811353631,5.29831736654804,0.693147180559945,4.4188406077966,0,0,3.63758615972639,5.40717177146012,2.39789527279837,3.25809653802148,5.94017125272043,7.87625888230323,4.29045944114839,5.50533153593236,3.43398720448515,1.38629436111989,3.3322045101752,1.09861228866811,5.88887795833288,2.77258872223978,5.91350300563827,3.29583686600433,5.24174701505964,5.92425579741453,7.15461535691366,0,5.13579843705026,8.02289686960146,3.43398720448515,2.63905732961526},
  {5.60947179518496,3.40119738166216,8.14177220465645,3.49650756146648,4.24849524204936,9.65496208861887,5.41164605185504,7.28892769452126,6.95749737087695,9.21064032698518,8.51579221050061,1.38629436111989,7.61874237767041,0,2.39789527279837,5.48063892334199,7.04838640872188,5.12989871492307,7.35691824235602,9.28535507578163,12.1278570177292,6.07764224334903,7.94944442025063,3.46573590279973,2.56494935746154,5.63835466933375,2.07944154167984,7.85399308722424,8.44074401925283,7.26612877955645,5.50125821054473,7.15695636461564,11.9148911238087,9.81754832785847,2.484906649788,10.6094028723738,11.6674903447191,8.50370260123374,6.04737217904628},
  {1.94591014905531,1.38629436111989,1.6094379124341,0.693147180559945,5.03695260241363,7.12044437239249,6.29526600143965,0.693147180559945,2.56494935746154,4.47733681447821,7.45876269238096,0,3.09104245335832,0,1.09861228866811,4.71849887129509,3.25809653802148,0,5.26269018890489,4.15888308335967,4.77068462446567,1.94591014905531,0,0,0,0,0,8.3654396361887,1.09861228866811,4.35670882668959,1.38629436111989,1.79175946922805,3.73766961828337,11.5262759493384,3.95124371858143,5.5683445037611,6.22059017009974,1.09861228866811,1.38629436111989},
  {0.693147180559945,0,4.57471097850338,0.693147180559945,1.94591014905531,5.54126354515843,4.40671924726425,5.5683445037611,2.94443897916644,8.00469951054955,7.2291138777933,0,5.96614673912369,0,0,4.40671924726425,2.83321334405622,1.09861228866811,3.97029191355212,4.69134788222914,8.37953902611744,1.6094379124341,2.89037175789616,0.693147180559945,0,0.693147180559945,0,5.62040086571715,0.693147180559945,4.27666611901606,1.38629436111989,1.94591014905531,7.56371966841437,7.93987157636188,2.19722457733622,7.88532923927319,9.51214721847336,4.24849524204936,3.46573590279973},
  {3.09104245335832,0,6.21860011969173,0,2.484906649788,7.28892769452126,3.58351893845611,6.59987049921284,7.72400465667607,6.53813982376767,5.73657229747919,0,6.89972310728487,0,3.49650756146648,3.89182029811063,7.01481435127554,2.56494935746154,6.85646198459459,7.20563517641036,11.3910063876739,3.73766961828337,7.02108396428914,4.67282883446191,4.04305126783455,5.63835466933375,0.693147180559945,5.53733426701854,5.24174701505964,5.95842469302978,5.38449506278909,4.81218435537242,9.47355043250348,7.68708015578313,1.94591014905531,9.49709701635146,8.67077227934454,2.70805020110221,3.3322045101752},
  {5.14749447681345,3.17805383034795,5.97635090929793,3.3322045101752,5.75890177387728,9.76192398821434,8.24012129807647,7.49665243816828,8.48549610467298,7.44658509915773,10.1617279408878,0,7.49052940206071,0,5.2040066870768,7.71912984090673,8.52615293278771,0.693147180559945,8.1185050675871,9.20261057391424,11.6497003418082,8.54946675196653,9.75463945579971,7.53849499941346,4.40671924726425,7.32184971378836,1.6094379124341,10.0638190914385,4.91265488573605,9.89762037425808,7.58882987830781,8.51719319141624,5.9427993751267,11.5929835571408,5.44673737166631,10.392680876175,10.1982073023396,2.07944154167984,6.14846829591765},
  {6.58340922215876,5.06259503302697,5.73334127689775,2.39789527279837,7.60638738977265,11.5292022760319,9.07988994259212,3.8286413964891,7.05703698169789,7.49331724886214,11.1519412494434,0.693147180559945,6.59441345974978,0,1.38629436111989,8.8209946457479,5.75890177387728,1.09861228866811,8.19808924895612,9.38957383217091,8.58783803098557,5.42934562895444,6.57646956904822,4.55387689160054,1.79175946922805,4.20469261939097,3.78418963391826,11.0108613468728,5.27299955856375,8.43879912398823,5.33753807970132,6.95654544315157,8.55410354543633,13.1291562534919,6.16331480403464,7.01481435127554,9.20039104112251,4.67282883446191,6.73221070646721},
  {0,0,0,0,0,0.693147180559945,0,0,0,0,1.6094379124341,3.78418963391826,0,0,0,0,0,0,0,0,2.19722457733622,0,0.693147180559945,0,0,0,0,0,0,1.6094379124341,0,1.09861228866811,0.693147180559945,2.30258509299405,0,0,5.61312810638807,0,0},
  {4.18965474202643,3.04452243772342,6.13122648948314,1.79175946922805,5.55682806169954,7.98956044933387,7.75705114203201,5.40267738187228,6.62671774924902,7.5522372875608,9.99003215393631,0,7.20637729147225,0,2.99573227355399,7.25770767716004,6.57507584059962,2.89037175789616,7.04228617193974,9.31235529738291,10.0326280693592,5.96100533962327,7.61874237767041,4.53259949315326,2.484906649788,4.98360662170834,2.77258872223978,8.89412164138221,6.24804287450843,8.08240225392624,5.64190707093811,5.84643877505772,10.3623670372789,11.1576495419452,5.03043792139244,7.86172707782398,11.4685973311207,5.01727983681492,5.59471137960184},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {1.6094379124341,0,2.39789527279837,0,0,4.33073334028633,1.09861228866811,0,4.14313472639153,0,1.38629436111989,0,1.6094379124341,0,0,0,4.34380542185368,0,3.25809653802148,2.19722457733622,7.17625453201714,1.38629436111989,2.30258509299405,3.2188758248682,0,2.19722457733622,0,1.09861228866811,1.09861228866811,2.484906649788,1.38629436111989,2.30258509299405,1.09861228866811,3.98898404656427,0,5.46383180502561,2.89037175789616,0,0},
  {2.19722457733622,1.6094379124341,4.95582705760126,2.19722457733622,2.83321334405622,5.35658627467201,4.56434819146784,1.6094379124341,2.77258872223978,6.63594655568665,6.9782137426307,1.94591014905531,6.38856140554563,0,0,5.46806014113513,2.94443897916644,5.00394630594546,4.63472898822964,5.28320372873799,6.91373735065968,3.68887945411394,4.02535169073515,1.38629436111989,0,2.39789527279837,0,7.05358572719368,4.11087386417331,4.85203026391962,2.94443897916644,3.52636052461616,10.0127006375094,8.36427508499152,1.09861228866811,4.77068462446567,10.737787012852,6.2709884318583,3.2188758248682},
  {3.68887945411394,0,6.26530121273771,2.07944154167984,3.55534806148941,7.95050243480885,6.61606518513282,5.23644196282995,8.15075647027555,8.0452677166078,8.44569718971117,0,8.31801027754687,0,2.99573227355399,4.97673374242057,10.2273448399312,4.06044301054642,6.0282785202307,9.13183814382123,10.9227138622816,5.55295958492162,7.54115245513631,4.56434819146784,2.63905732961526,6.13988455222626,0,8.34545542816193,4.24849524204936,7.12367278520461,6.40025744530882,6.95749737087695,9.01481198769495,10.0083879623615,4.06044301054642,9.29633456514304,10.0354364436654,3.58351893845611,2.77258872223978},
  {2.89037175789616,1.94591014905531,2.56494935746154,0,2.19722457733622,5.63835466933375,5.65599181081985,0.693147180559945,3.29583686600433,5.31811999384422,7.7848892956551,0,4.11087386417331,0,0,5.74620319054015,1.94591014905531,1.94591014905531,4.969813299576,5.11799381241676,5.98645200528444,2.07944154167984,0,0,0,0.693147180559945,1.6094379124341,7.22329567956231,3.25809653802148,5.12989871492307,4.76217393479776,4.43081679884331,7.44775128004791,8.43620003220671,2.484906649788,4.20469261939097,7.49831587076698,2.30258509299405,3.46573590279973},
  {1.79175946922805,0,5.25227342804663,0.693147180559945,3.17805383034795,6.6052979209482,5.77455154554441,3.66356164612965,5.23644196282995,7.79564653633459,8.02975852044082,1.38629436111989,6.99393297522319,0,0.693147180559945,5.39362754635236,5.18738580584075,4.4188406077966,5.4249500174814,6.97447891102505,8.96200720958831,5.11799381241676,5.55682806169954,2.63905732961526,1.09861228866811,3.17805383034795,0,7.46393660446893,2.94443897916644,6.46302945692067,4.00733318523247,5.28320372873799,9.61959827832304,9.05345261643904,3.04452243772342,7.73017479524622,10.5330024678512,5.75890177387728,3.43398720448515},
  {5.18178355029209,2.07944154167984,8.47657950853094,4.17438726989564,5.49306144334055,9.98534399900596,5.80814248998044,6.39024066706535,7.88419993367604,7.23561914106675,8.60630236648801,0,8.21365270303,0,3.95124371858143,7.07749805356923,7.26892012819372,4.00733318523247,7.01660968389422,10.5441301791139,11.6535044647674,5.11799381241676,8.41715183723601,3.46573590279973,3.8286413964891,6.57507584059962,1.38629436111989,8.34687925374656,12.7074810663051,6.52941883826223,6.08449941307517,6.81563999007433,9.07566546864958,10.4780763969719,4.0943445622221,8.73214326770192,10.774592616233,5.07517381523383,5.93753620508243},
  {6.8596149036542,5.75257263882563,9.50962981746968,4.76217393479776,7.2086003379602,11.1420067006146,10.0245983782852,8.61450137388324,9.70692507345183,11.8835368440878,12.2178678082875,2.77258872223978,11.7296726027792,0,4.55387689160054,9.43962502804716,9.9259826303635,9.39831260027895,9.38286408629003,11.044600426103,13.4532184386224,11.3739162392328,9.30946146284399,7.48661331313996,5.35185813347607,7.80954132465341,5.00394630594546,11.553616250883,6.92264389147589,10.0902160511483,8.65973387819835,9.76382310540815,12.7756727099944,13.2586811345074,7.70706265537047,12.2797087206437,13.8272721188367,8.42244285487043,8.19505769089508},
  {3.40119738166216,2.19722457733622,6.63068338564237,2.99573227355399,7.60986220091355,7.29369772060144,6.91373735065968,2.484906649788,6.94697599213542,8.89809234557915,9.49852231946961,0,6.63331843328038,0,0.693147180559945,6.80350525760834,4.74493212836325,4.44265125649032,6.46458830368996,7.99395754757357,10.5946076800114,11.5041672232963,6.20657592672493,4.72738781871234,1.38629436111989,4.00733318523247,2.07944154167984,9.83499455609083,3.91202300542815,7.53369370984863,6.31173480915291,9.09391890895893,9.73044283252238,11.0611231816537,4.47733681447821,6.70073110954781,11.1511949057749,4.24849524204936,4.86753445045558},
  {4.02535169073515,1.6094379124341,7.26892012819372,3.91202300542815,4.35670882668959,8.77755545321306,7.4079243225596,5.79605775076537,8.32457884513685,9.01091334727929,9.3904929114853,0.693147180559945,8.93813787037279,0,3.40119738166216,6.43615036836943,9.05286751315162,3.55534806148941,7.66762609158499,9.31739944426959,11.9264711702698,7.35244110024358,10.2397454804806,7.37588214821501,4.59511985013459,9.16209505934819,1.6094379124341,9.33626792857397,4.07753744390572,8.37216741936598,8.10319175228579,10.0306046675956,10.3832249050189,10.8365174004146,4.44265125649032,9.15080265925999,10.663592201221,4.55387689160054,4.72738781871234},
  {1.09861228866811,1.09861228866811,4.29045944114839,0.693147180559945,2.70805020110221,5.45958551414416,5.39362754635236,3.40119738166216,7.87549929244521,7.19368581839511,7.48605261786314,0,6.23048144757848,0,0,4.77068462446567,6.99209642741589,0,4.68213122712422,6.97354301952014,9.55640927012769,5.80513496891649,9.29339392711147,5.88610403145016,0.693147180559945,3.43398720448515,0,7.9536697786498,1.09861228866811,5.73009978297357,3.93182563272433,6.99759598298193,7.9098566672694,8.82570677344795,2.56494935746154,7.21229446850034,8.55024104546244,1.09861228866811,2.19722457733622},
  {0,0,3.13549421592915,0,0,3.17805383034795,1.6094379124341,0,3.66356164612965,3.49650756146648,4.00733318523247,0,2.89037175789616,0,0.693147180559945,1.94591014905531,2.484906649788,0,0.693147180559945,3.87120101090789,6.85118492749374,1.09861228866811,2.07944154167984,0,2.83321334405622,2.19722457733622,0,3.8286413964891,3.09104245335832,2.07944154167984,1.79175946922805,2.19722457733622,5.11198778835654,5.14166355650266,1.09861228866811,4.54329478227,6.87212810133899,0,0},
  {2.39789527279837,0,5.4971682252932,0,3.2188758248682,6.44094654063292,4.27666611901606,2.70805020110221,6.26339826259162,6.56526497003536,6.92362862813843,0,6.04263283368238,0,1.09861228866811,4.46590811865458,6.13988455222626,3.25809653802148,4.95582705760126,6.8330317327862,10.0825956182606,3.8286413964891,6.14846829591765,4.4188406077966,4.29045944114839,6.60394382460047,0,6.70196036600254,2.484906649788,5.43372200355424,4.77912349311153,5.39362754635236,7.81762544305337,8.03786623470962,1.6094379124341,7.33236920592906,9.53589609685605,2.94443897916644,2.63905732961526},
  {0,0,1.79175946922805,0,1.09861228866811,3.2188758248682,0.693147180559945,0,0,1.38629436111989,3.04452243772342,0,0.693147180559945,0,0,0.693147180559945,0,0,0.693147180559945,3.25809653802148,4.14313472639153,0,0.693147180559945,0,0,0,3.63758615972639,1.94591014905531,0,1.38629436111989,0,0,4.99721227376411,5.03695260241363,0,0.693147180559945,5.73979291217923,0.693147180559945,1.38629436111989},
  {5.43372200355424,2.70805020110221,7.49443021503157,5.6970934865054,5.20948615284142,10.0116690853807,8.27868216297091,6.41017488196617,9.20170317858052,4.92725368515721,9.34862295977619,0,9.00368513816677,0,5.55295958492162,7.76472054477148,9.8224943933266,0,8.39502555744203,10.4118401208197,12.1845731794169,9.57623270496452,11.2029432490235,9.37245922145262,5.14166355650266,8.2684753889826,3.09104245335832,9.03431892773071,5.90808293816893,11.1200754509096,9.35539264367532,10.6962764274229,6.94601399109923,11.4704562812451,5.25227342804663,9.75597313724758,9.53870842969938,1.09861228866811,6.62804137617953},
  {4.91265488573605,2.07944154167984,7.23993259132047,3.68887945411394,4.98360662170834,9.7878522089372,6.70808408385307,6.3578422665081,8.65259782842244,7.42416528104203,9.07840770071536,1.09861228866811,9.86599334810855,0,3.89182029811063,7.49997654095212,8.44998444172279,3.97029191355212,7.47647238116391,9.23073106162392,11.7189798242907,6.4707995037826,8.32675881451173,5.70044357339069,4.39444915467244,6.89060912014717,2.484906649788,8.67573421954479,5.73009978297357,7.48155570190952,6.76619171466035,7.25205395185281,9.79087860815347,10.4671522753178,4.11087386417331,9.503009985939,11.3312357085484,6.31535800152233,6.74405918631135},
  {5.12989871492307,4.00733318523247,9.01042494678118,3.36729582998647,5.70044357339069,9.60427256427062,8.20685642839965,6.75110146893676,8.06085575293432,8.47010158388239,10.8545854259157,0.693147180559945,8.03463103292311,0,4.21950770517611,8.19007704971905,7.89095671613892,3.3322045101752,7.86211221166275,10.3441589163789,11.6569738595427,6.05678401322862,9.32331185063534,4.99043258677874,2.39789527279837,5.99893656194668,3.49650756146648,10.1950371365144,9.7971821461652,9.04204005654448,7.60240133566582,8.29429960885724,10.6416797978892,11.7813253246867,5.08140436498446,9.56878375131088,10.186898014637,6.51767127291227,6.59441345974978},
  {2.56494935746154,1.94591014905531,5.05624580534831,1.94591014905531,3.13549421592915,7.34277918933185,5.30826769740121,4.43081679884331,6.21060007702465,6.43294009273918,7.90470391387375,0.693147180559945,5.8805329864007,0,2.07944154167984,5.35658627467201,5.77455154554441,1.6094379124341,5.74620319054015,7.6515955738576,9.70497563634345,3.61091791264422,5.96870755998537,1.6094379124341,1.79175946922805,5.12396397940326,2.63905732961526,6.58202513889283,2.56494935746154,6.61204103483309,5.88332238848828,4.83628190695148,8.73182058296211,9.34626888920043,3.04452243772342,8.01994168767737,9.08930204359913,4.15888308335967,4.88280192258637},
  {3.46573590279973,1.6094379124341,8.35443894011481,6.38687931936265,4.07753744390572,7.6657534318617,7.35308192051543,4.04305126783455,6.5410299991899,7.49609734517596,9.57955634740923,0,9.4937884938959,0,1.94591014905531,5.71042701737487,7.58273848891441,2.56494935746154,6.33505425149806,8.923591197573,10.6168049398855,7.10167597161944,8.61122983334262,6.13339804299665,3.25809653802148,6.29894924685594,0,10.1188811503903,4.62497281328427,8.56883642456808,6.361302477573,11.1755908566134,9.64147322683293,10.6732253352578,4.18965474202643,8.02158453345511,10.8744369097141,4.57471097850338,4.62497281328427},
  {6.25958146406492,3.46573590279973,8.9142228207033,4.98360662170834,5.61677109766657,11.4945781781522,7.57712193087668,9.10420177591451,9.97878053657156,6.80461452006262,10.1574318530031,0,8.45190772471761,0,5.4971682252932,8.80627428478173,9.25941620962278,1.6094379124341,8.87654455055838,11.3662567254907,13.1789497387646,9.33291192436436,10.3076184376312,7.91461770904068,5.52942908751142,8.37655086161377,4.36944785246702,9.31937413300031,7.44658509915773,10.19653023123,8.56750600528983,9.01262087300213,8.19312372151207,11.3590514135445,5.95064255258773,12.0064991257284,11.2052311432531,6.21860011969173,7.88457651059632},
  {7.30653139893951,5.54907608489522,9.9390959800035,5.72358510195238,7.06219163228656,11.689396608086,9.73761004815811,8.85765744930699,10.2264040380091,10.6290051131265,11.382930668354,2.56494935746154,10.7406917860895,0,6.20050917404269,9.58273117235492,10.422935893593,6.37842618365159,9.6513656554829,12.0766584797686,13.2504364001956,9.9140317664118,11.3596926970662,8.85008760668957,6.02102334934953,8.7690408108588,3.91202300542815,11.6667017890208,8.90937040519747,11.6803617842647,9.4776156346503,10.1000817686168,12.906637248868,13.1347503412152,7.71556953452021,11.4312055181839,13.1120827119967,9.43364391049176,7.83676478326407},
  {0.693147180559945,0,0,0,2.07944154167984,4.71849887129509,4.92725368515721,0,0.693147180559945,2.484906649788,5.95064255258773,0,1.09861228866811,0,0,0.693147180559945,1.38629436111989,0,2.484906649788,1.09861228866811,3.46573590279973,0,0,0,0,0,0,4.82028156560504,0,0,0,0,1.94591014905531,8.89562962713648,2.63905732961526,3.49650756146648,5.07517381523383,0,0},
  {3.25809653802148,2.484906649788,8.07496035911586,2.07944154167984,4.24849524204936,8.47969898698866,7.56837926783652,6.4377516497364,7.49997654095212,10.5322561991599,9.87034433394287,0,9.79104647319038,0,1.09861228866811,6.94215670569947,7.08840877867539,5.59842195899838,6.98100574072173,7.83439230291044,12.5804185345795,5.01063529409626,6.50428817353665,4.24849524204936,2.89037175789616,4.80402104473326,0,8.66750795207511,4.11087386417331,7.46794233228585,6.60665018619822,6.79346613258001,10.6581765811907,10.7126606704033,5.0998664278242,11.0900649299329,12.2459566002286,5.95064255258773,4.77912349311153},
  {7.12367278520461,5.43372200355424,8.53306654057253,6.50428817353665,7.30854279753919,10.8774054772451,10.4440952545866,7.40184157874383,9.89060492670511,11.9269736330089,12.1771020202786,5.30826769740121,9.75202492332816,0,5.85507192220243,9.94184250641259,10.6460913418087,6.21260609575152,9.97091252885092,11.4764792991981,12.922228094139,11.3878383191284,11.7750358510595,9.83862898018763,7.05617528410041,10.0090180537456,5.75574221358691,12.1578483212432,7.55118686729615,12.2218377211086,9.08726837438619,11.2361041998512,10.2817869925715,13.1343808771216,7.20934025660291,10.764836236146,11.869935352809,6.55250788703459,8.05610965954506},
  {1.09861228866811,0,1.6094379124341,0.693147180559945,1.38629436111989,2.63905732961526,0,0,0,2.19722457733622,3.17805383034795,0,1.09861228866811,0,0,0,1.38629436111989,0.693147180559945,0,1.79175946922805,3.66356164612965,1.79175946922805,1.38629436111989,0,0,0,0.693147180559945,0.693147180559945,1.09861228866811,2.83321334405622,0,0,2.39789527279837,4.15888308335967,0,0.693147180559945,10.1809677625033,5.48063892334199,0},
  {2.63905732961526,1.09861228866811,3.52636052461616,1.38629436111989,2.99573227355399,6.59987049921284,2.70805020110221,4.49980967033027,4.38202663467388,5.14749447681345,5.50533153593236,0,4.29045944114839,0,0,4.58496747867057,2.63905732961526,1.09861228866811,3.58351893845611,6.62273632394984,8.16422565226583,2.39789527279837,4.49980967033027,0.693147180559945,0,2.19722457733622,0,5.32787616878958,1.6094379124341,3.2188758248682,3.04452243772342,3.73766961828337,8.57395152523485,7.7944112057266,0,5.34233425196481,8.16251625014018,3.8286413964891,4.78749174278205}
};


int bisearch( const char* str , const char** array , int size )
{  
  if( !str || !array )
    return -1;

  int low, high, mid, r;        
  low = 0;
  high = size-1;
  while(low <= high)
  {
    mid = (low + high) >> 1;
    r = strcmp(str, array[mid]);
    if( r< 0)
      high = mid - 1;
    else if(r >0)
      low = mid + 1;
    else 
      return mid;
  }
  return -1;
}


const char* get_pos_str( unsigned int nPOS )
{
  if(nPOS <= 0 || nPOS > POS_TAG_COUNT)
    return 0;

  return POS_TAG_SET[nPOS-1];
}

unsigned int get_pos_val( const char* strPOS )
{
  return bisearch(strPOS,POS_TAG_SET,POS_TAG_COUNT) + 1;
}


tag_dict_t* tag_dict_load( char* dictpath )
{
  tag_dict_t* p = new tag_dict_t();
  if( !p )
  {
    LOG_ERROR("error: creating dictionary object failed");
    return NULL;
  }

  p->dict = 0;
  p->size = 0;
  p->buffer = 0;  
 
  char filename[MAX_PATH_LENG] = {0};
  strncpy(filename,TERM_TAG_DICT,strlen(TERM_TAG_DICT)+1);
  p->dict = ds_load(dictpath, filename);
  if( !p->dict )
  {
    LOG_ERROR("error: loading binary index dictionary failed");
    delete p;
    return NULL;
  }

  snprintf(filename,512,"%s/%s%s",dictpath,TERM_TAG_DICT,DATA_DICT_POSTFIX);
  FILE* fp = fopen(filename,"rb");
  if( !fp )
  {
    LOG_ERROR("error: opening binary data dictionary failed");
    ds_del(p->dict);
    delete p;
    return NULL;
  }

  fread(&p->size,sizeof(int),1,fp);
  if( p->size )
  {
    p->buffer = new unsigned char[p->size];
    fread(p->buffer,sizeof(char),p->size,fp);
  }
  else
  {
    LOG_ERROR("error: loading binary data dictionary failed");
    ds_del(p->dict);
    delete p;
    p = NULL;
  }

  fclose(fp);
  return p;
}

void tag_dict_free( tag_dict_t* p )
{
  if( !p )
    return;

  if( p->dict )
  {
    ds_del(p->dict);
    p->dict = 0;
  }

  if( p->buffer )
  {
    delete p->buffer;
    p->buffer = 0;
  }

  delete p;
}

int tag_dict_find( tag_dict_t* p, char* key )
{
  if( !p || !key )
    return -1;

  Sdict_snode dictNode;  
  creat_sign_f64(key, strlen(key), &dictNode.sign1, &dictNode.sign2);
  if( ds_op1(p->dict, &dictNode, SEEK) == 1 )
    return dictNode.code;

  return -1;
}
